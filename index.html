<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Fiszki ‚Äì Pozytywizm (Mobile)</title>
<style>
  :root{
    --bg:#0d0e12; --bg2:#141520; --panel:#1a1b28; --fg:#f2f3f7; --muted:#b8bbd0;
    --accent:#7c5cff; --accent2:#24c8ff; --ok:#2ecc71; --warn:#ffb020; --danger:#ff5c5c;
    --radius:16px;
  }
  *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#0b0c12,#10121a);
    color:var(--fg); font:16px/1.5 Inter, system-ui, Segoe UI, Roboto, Arial;
    display:flex; flex-direction:column; gap:0;
  }

  header{
    position:sticky; top:0; z-index:20;
    background:rgba(20,21,32,.9); backdrop-filter: blur(10px);
    border-bottom:1px solid #23243a;
  }
  .wrap{max-width:1000px; margin:0 auto; padding:14px 16px; }
  h1{margin:0; font-size:20px; letter-spacing:.2px}
  .sub{color:var(--muted); font-size:13px; margin-top:2px}

  /* TOOLBAR */
  .toolbar{display:flex; gap:10px; margin-top:10px; align-items:center; flex-wrap:wrap}
  .toolbar input[type="search"], .toolbar select{
    flex:1; min-width:140px; background:#1e2030; color:var(--fg);
    border:1px solid #2a2c44; border-radius:12px; padding:12px 14px; font-size:16px; outline:none;
  }
  .btn{
    background:linear-gradient(180deg,var(--accent),#5b44ef); color:#fff;
    border:none; padding:12px 16px; border-radius:14px; font-weight:700; font-size:16px;
    box-shadow:0 10px 28px rgba(124,92,255,.25); cursor:pointer; touch-action:manipulation;
  }
  .btn.ghost{background:transparent; border:1px solid #2c2e48; box-shadow:none}
  .btn.flat{background:#23243a; box-shadow:none}
  .btn.ok{background:linear-gradient(180deg,var(--ok),#1eac5c)}
  .btn.warn{background:linear-gradient(180deg,var(--warn),#f59e0b); color:#111}
  .btn:active{transform:translateY(1px)}
  .spacer{flex:1}

  /* PROGRESS */
  .progress{height:12px; background:#1a1b28; border:1px solid #27283d; border-radius:999px; overflow:hidden}
  .bar{height:100%; width:0%; background:linear-gradient(90deg,var(--accent2),var(--accent)); transition:width .25s}

  /* GRID */
  main{flex:1; min-height:0}
  .grid{
    display:grid; gap:12px; padding:12px 12px calc(100px + env(safe-area-inset-bottom)); /* miejsce na footer */
    grid-template-columns:repeat( auto-fill, minmax(180px, 1fr) );
  }
  @media (min-width:520px){
    .grid{grid-template-columns:repeat( auto-fill, minmax(220px, 1fr) );}
  }
  .card{
    background:radial-gradient(120% 120% at 80% 0%, #26263a 0%, #1b1b28 60%, #181822 100%);
    border:1px solid #2b2b39; border-radius:var(--radius);
    height:180px; display:flex; align-items:center; justify-content:center;
    cursor:pointer; perspective:1000px; position:relative; user-select:none;
    box-shadow:0 12px 40px rgba(0,0,0,.3);
  }
  .inner{position:relative; width:100%; height:100%; transition:transform .5s; transform-style:preserve-3d}
  .card.flipped .inner{transform:rotateY(180deg)}
  .front,.back{
    position:absolute; inset:0; backface-visibility:hidden; display:flex; align-items:center; justify-content:center;
    padding:14px; text-align:center; border-radius:var(--radius); font-weight:700; font-size:16px;
  }
  .front{color:#f0f2ff}
  .back{transform:rotateY(180deg); background:#242437}
  .tag{
    position:absolute; top:8px; left:8px; font-size:11px; color:#c9cbff; background:#2a2a44;
    padding:6px 9px; border-radius:999px; border:1px solid #3a3a57
  }
  .known{position:absolute; bottom:8px; right:8px; font-size:11px; color:#15d07a; background:#123b2a; padding:6px 9px; border-radius:999px; border:1px solid #1b5a3f}
  .counter{position:absolute; bottom:8px; left:8px; font-size:11px; color:#9adfff; background:#0f3440; padding:6px 9px; border-radius:999px; border:1px solid #115166}

  /* STUDY CARD (full-screen on mobile) */
  .study-card{
    position:fixed; left:0; right:0; top:0; bottom:calc(88px + env(safe-area-inset-bottom));
    margin:12px; border-radius:18px; border:1px solid #32324a; display:none;
    background:radial-gradient(120% 120% at 80% 0%, #2a2a48 0%, #1d1d2d 60%, #161622 100%);
    justify-content:center; align-items:center; cursor:pointer; perspective:1200px; z-index:30;
    box-shadow:0 24px 90px rgba(0,0,0,.45)
  }
  .study-card.show{display:flex}
  .study-card .front,.study-card .back{padding:20px; font-size:20px}
  .study-card .tag{top:10px; left:12px}
  .study-card .counter{bottom:10px; left:12px}

  /* BOTTOM BAR (big touch targets) */
  .study{
    position:fixed; left:0; right:0; bottom:0; z-index:40;
    background:rgba(16,17,26,.95); backdrop-filter: blur(10px); border-top:1px solid #26263a;
    padding:10px 12px calc(10px + env(safe-area-inset-bottom));
    display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px;
  }
  .study .btn{padding:14px 10px; font-size:17px; border-radius:14px}
  .study .wide{grid-column: span 3}
  .stats{grid-column: span 3; text-align:center; color:var(--muted); font-size:13px; margin-top:4px}

  /* Floating FAB for tryb nauki */
  .fab{
    position:fixed; right:16px; bottom:calc(100px + env(safe-area-inset-bottom)); z-index:35;
    background:linear-gradient(180deg,var(--accent2),var(--accent)); color:#fff; border:none;
    width:56px; height:56px; border-radius:50%; box-shadow:0 14px 32px rgba(70,120,255,.35);
    font-size:22px; font-weight:800; cursor:pointer;
  }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Fiszki ‚Äì Pozytywizm</h1>
    <div class="sub">Mobile-first ‚Ä¢ kliknij kartƒô, by odwr√≥ciƒá ‚Ä¢ gesty ‚Äû‚Üê/‚Üí‚Äù zmieniajƒÖ fiszkƒô</div>

    <div class="toolbar">
      <input id="q" type="search" placeholder="üîé Szukaj‚Ä¶" aria-label="Szukaj" />
      <select id="tag" aria-label="Filtruj po zagadnieniu">
        <option value="">Wszystkie</option>
      </select>
      <button class="btn flat" id="shuffle" aria-label="Tasuj fiszki">Tasuj</button>
    </div>

    <div class="progress" aria-label="postƒôp">
      <div class="bar" id="bar"></div>
    </div>
  </div>
</header>

<main>
  <div id="grid" class="grid" aria-live="polite"></div>
</main>

<!-- P≈ÇywajƒÖcy przycisk szybkiego startu -->
<button class="fab" id="fab" title="Tryb nauki">‚ñ∂</button>

<!-- Karta nauki pe≈Çnoekranowa -->
<div id="studyCard" class="study-card" title="Stuknij / przesu≈Ñ, aby sterowaƒá">
  <div class="inner">
    <div class="front"></div>
    <div class="back"></div>
  </div>
  <div class="tag"></div>
  <div class="counter"></div>
</div>

<!-- Du≈ºe przyciski u do≈Çu (zawsze) -->
<div class="study" id="studyBar">
  <button class="btn" id="prev" aria-label="Poprzednia">‚Üê</button>
  <button class="btn ok" id="know" aria-label="Znam">Znam ‚úì</button>
  <button class="btn warn" id="again" aria-label="Powt√≥rz">Powt√≥rz ‚Ü∫</button>
  <button class="btn ghost wide" id="flip">Odwr√≥ƒá (stuknij kartƒô)</button>
  <div class="stats" id="stats">0/0 ‚Ä¢ 0% opanowane</div>
</div>

<script>
/** DANE FISZEK **/
const CARDS = [
  {tag:'Ramy epoki', q:'Ramy czasowe pozytywizmu w Polsce?', a:'1864 (po powstaniu styczniowym) ‚Äì ok. 1890/1895 (M≈Çoda Polska na horyzoncie).'},
  {tag:'Has≈Ça spo≈Çeczne', q:'Praca u podstaw ‚Äì definicja', a:'Podnoszenie poziomu najni≈ºszych warstw: o≈õwiata, samopomoc, edukacja.'},
  {tag:'Has≈Ça spo≈Çeczne', q:'Praca organiczna ‚Äì na czym polega?', a:'Spo≈Çecze≈Ñstwo jak organizm ‚Äì wsp√≥≈Çpraca wszystkich warstw dla rozwoju.'},
  {tag:'Has≈Ça spo≈Çeczne', q:'Asymilacja ≈ªyd√≥w ‚Äì sens w pozytywizmie', a:'W≈ÇƒÖczenie w ≈ºycie gospodarcze i kulturalne, edukacja, wsp√≥lna praca.'},
  {tag:'Has≈Ça spo≈Çeczne', q:'Emancypacja kobiet ‚Äì co postulowano?', a:'R√≥wne prawa: dostƒôp do nauki i pracy, samodzielno≈õƒá ekonomiczna.'},
  {tag:'Filozofia', q:'Scjentyzm (August Comte) ‚Äì istota', a:'Nauka (≈õcis≈Ça i przyrodnicza) jako najpewniejsze ≈∫r√≥d≈Ço wiedzy i postƒôpu.'},
  {tag:'Filozofia', q:'Utylitaryzm (J. S. Mill) ‚Äì zasada', a:'‚ÄûNajwiƒôksze szczƒô≈õcie najwiƒôkszej liczby‚Äù ‚Äì kryterium u≈ºyteczno≈õci.'},
  {tag:'Filozofia', q:'Empiryzm ‚Äì co g≈Çosi?', a:'Poznajemy ≈õwiat poprzez do≈õwiadczenie i obserwacjƒô.'},
  {tag:'Kierunki', q:'Realizm ‚Äì definicja', a:'Wierne odzwierciedlenie rzeczywisto≈õci; typowo≈õƒá postaci i sytuacji.'},
  {tag:'Kierunki', q:'Naturalizm ‚Äì definicja', a:'Skrajny realizm; determinizm biologiczno-spo≈Çeczny, brutalny konkret.'},
  {tag:'Styl', q:'Archaizacja jƒôzyka ‚Äì co to?', a:'Celowe u≈ºycie dawnych form dla stylu historycznego i ‚Äûsmaku epoki‚Äù.'},
  {tag:'Lalka', q:'‚ÄûLalka‚Äù ‚Äì autor i nurt', a:'Boles≈Çaw Prus; powie≈õƒá realistyczna z elementami naturalizmu/obyczajowej.'},
  {tag:'Lalka', q:'Stanis≈Çaw Wokulski ‚Äì charakterystyka', a:'Pozytywista-przedsiƒôbiorca i romantyk; rozdarty miƒôdzy uczuciem a pracƒÖ.'},
  {tag:'Lalka', q:'Ignacy Rzecki ‚Äì rola narracji', a:'Stary subiekt; jego pamiƒôtnik to odrƒôbna warstwa narracyjna.'},
  {tag:'Lalka', q:'Warstwa spo≈Çeczna w ‚ÄûLalce‚Äù', a:'Przekr√≥j Warszawy: arystokracja, mieszcza≈Ñstwo, ubodzy, ≈ªydzi, inteligencja.'},
  {tag:'Lalka', q:'WƒÖtki pozytywistyczne w ‚ÄûLalce‚Äù', a:'Praca u podstaw/organiczna, asymilacja ≈ªyd√≥w, kwestia kobiet.'},
  {tag:'Lalka', q:'Czas i miejsca akcji', a:'Warszawa lata 70. XIX w.; epizody: Pary≈º, Zas≈Çawek.'},
  {tag:'Lalka', q:'‚ÄûLalka‚Äù ‚Äì znaczenie tytu≈Çu', a:'Dos≈Çownie: lalka Ma≈Çgosi; metaforycznie: pozorno≈õƒá, uprzedmiotowienie.'},
  {tag:'Potop', q:'‚ÄûPotop‚Äù ‚Äì autor i cykl', a:'Henryk Sienkiewicz; czƒô≈õƒá Trylogii; powie≈õƒá historyczno-przygodowa.'},
  {tag:'Potop', q:'Czas historyczny', a:'1655‚Äì1660 ‚Äì najazd szwedzki (potop).'},
  {tag:'Potop', q:'Andrzej Kmicic ‚Äì przemiana', a:'Od awanturnika do patrioty (Babinicz); motyw odkupienia.'},
  {tag:'Potop', q:'Archaizacja w ‚ÄûPotopie‚Äù ‚Äì rola', a:'Buduje klimat epoki i wiarygodno≈õƒá (sk≈Çadnia/leksyka dawna).'},
  {tag:'Potop', q:'Motywy przewodnie', a:'Patriotyzm, zdrada/wierno≈õƒá, honor rycerski, mi≈Ço≈õƒá, obrona Jasnej G√≥ry.'},
  {tag:'Kontrolne', q:'Has≈Ça programowe pozytywizmu ‚Äì 4', a:'Praca u podstaw, praca organiczna, emancypacja kobiet, asymilacja ≈ªyd√≥w (+ scjentyzm, utylitaryzm).'},
  {tag:'Kontrolne', q:'Realizm vs naturalizm ‚Äì 1 zdanie', a:'Realizm ‚Äì wierne odtworzenie; naturalizm ‚Äì determinizm i ‚Äûbiologia‚Äù cz≈Çowieka.'},
  {tag:'Kontrolne', q:'Dlaczego odrzucano powstania?', a:'Stawiano na realny rozw√≥j: o≈õwiata, gospodarka, praca ‚Äì zamiast zryw√≥w.'}
];

/** STAN / POSTƒòPY **/
const LS_KEY='fiszki_pozytywizm_mobile_v1';
let state={order:[...CARDS.keys()],known:{},laps:{},idx:0};
try{ const s=JSON.parse(localStorage.getItem(LS_KEY)); if(s) state={...state,...s}; }catch(e){}

const $=id=>document.getElementById(id);
const grid=$('grid'), tagSel=$('tag'), search=$('q'), bar=$('bar'), stats=$('stats');
const studyCard=$('studyCard'), fab=$('fab');

/* TAGI */
[...new Set(CARDS.map(c=>c.tag))].forEach(t=>{
  const o=document.createElement('option'); o.value=t; o.textContent=t; tagSel.appendChild(o);
});

/* FILTRACJA */
let filtered=[];
function applyFilter(){
  const q=search.value.trim().toLowerCase(), tag=tagSel.value;
  filtered = CARDS.map((c,i)=>({i,...c}))
    .filter(c => (!tag || c.tag===tag) && (!q || c.q.toLowerCase().includes(q)||c.a.toLowerCase().includes(q)));
  // porzƒÖdek wg state.order
  filtered.sort((a,b)=> state.order.indexOf(a.i)-state.order.indexOf(b.i));
  renderGrid(); updateProgress();
}
function renderGrid(){
  grid.innerHTML='';
  filtered.forEach(({i,q,a,tag})=>{
    const d=document.createElement('div'); d.className='card'; d.dataset.index=i;
    d.innerHTML=`
      <div class="inner">
        <div class="front">${q}</div>
        <div class="back">${a}</div>
      </div>
      <div class="tag">${tag}</div>
      ${state.known[i] ? '<div class="known">ZNAM</div>' : ''}
      <div class="counter">powt.: ${state.laps[i]||0}</div>`;
    d.addEventListener('click',()=> d.classList.toggle('flipped'), {passive:true});
    d.addEventListener('dblclick',()=> markKnown(i,true));
    grid.appendChild(d);
  });
}
function updateProgress(){
  const total = filtered.length || CARDS.length;
  const knownCount = Object.keys(state.known).filter(k => filtered.find(f=>f.i==k)).length;
  const pct = total ? Math.round(knownCount*100/total) : 0;
  bar.style.width=pct+'%';
  stats.textContent = `${knownCount}/${total} ‚Ä¢ ${pct}% opanowane`;
}
function save(){ localStorage.setItem(LS_KEY, JSON.stringify(state)); }

/* OZNACZANIE */
function vibrate(ms=30){ if(navigator.vibrate) try{ navigator.vibrate(ms); }catch{} }
function markKnown(i,force=true){
  if(force) state.known[i]=true; else state.known[i] ? delete state.known[i] : state.known[i]=true;
  state.laps[i]=(state.laps[i]||0)+1; vibrate(25); save(); applyFilter();
}

/* TASOWANIE */
$('shuffle').onclick=()=>{
  const arr=filtered.map(f=>f.i);
  for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
  state.order=arr; state.idx=0; save(); applyFilter(); openStudy();
};

/* TRYB NAUKI ‚Äî pe≈Çny ekran na tel. */
let studyOpen=false, reveal=false;
const stFront=studyCard.querySelector('.front'), stBack=studyCard.querySelector('.back'), stTag=studyCard.querySelector('.tag'), stCnt=studyCard.querySelector('.counter');

function openStudy(){
  if(filtered.length===0) applyFilter();
  studyOpen=true; studyCard.classList.add('show'); showStudy();
}
function closeStudy(){ studyOpen=false; studyCard.classList.remove('show'); }
function showStudy(){
  const idx=Math.min(Math.max(state.idx,0), filtered.length-1);
  const it=filtered[idx]; stFront.textContent=it.q; stBack.innerHTML=it.a.replace(/\n/g,'<br>');
  stTag.textContent=it.tag; stCnt.textContent=`#${idx+1}/${filtered.length} ‚Ä¢ powt.: ${state.laps[it.i]||0}`;
  studyCard.classList.remove('flipped'); reveal=false;
}
function next(){ state.idx=Math.min(state.idx+1, filtered.length-1); save(); showStudy(); }
function prev(){ state.idx=Math.max(state.idx-1, 0); save(); showStudy(); }
function flip(){ studyCard.classList.toggle('flipped'); reveal=!reveal; vibrate(10); }

$('flip').onclick=flip;
$('prev').onclick=prev;
$('know').onclick=()=>{ markKnown(filtered[state.idx].i,true); next(); };
$('again').onclick=()=>{
  const id=filtered[state.idx].i; state.laps[id]=(state.laps[id]||0)+1; // prosty SRS
  const p=state.order.indexOf(id); const np=Math.min(p+3, state.order.length-1);
  state.order.splice(p,1); state.order.splice(np,0,id); save(); applyFilter(); vibrate(20); next();
};

studyCard.addEventListener('click', flip);

/* GESTY: swipe lewo/prawo */
let touchStartX=0, touchStartY=0, moved=false;
const THRESH=40, MAX_ANGLE=70; // px i akceptowalny kƒÖt
studyCard.addEventListener('touchstart', (e)=>{const t=e.changedTouches[0]; touchStartX=t.clientX; touchStartY=t.clientY; moved=false; }, {passive:true});
studyCard.addEventListener('touchmove', (e)=>{ moved=true; }, {passive:true});
studyCard.addEventListener('touchend', (e)=>{
  if(!moved) return; const t=e.changedTouches[0];
  const dx=t.clientX-touchStartX, dy=t.clientY-touchStartY;
  const angle=Math.abs(Math.atan2(dy,dx)*180/Math.PI);
  if(Math.abs(dx)>THRESH && angle<MAX_ANGLE){
    if(dx<0) { next(); vibrate(15); }
    else     { prev(); vibrate(15); }
  }
}, {passive:true});

/* FAB i skr√≥ty */
$('fab').onclick=()=> openStudy();
window.addEventListener('keydown',(e)=>{
  if(e.key===' ') { e.preventDefault(); flip(); }
  if(e.key==='ArrowRight') next();
  if(e.key==='ArrowLeft')  prev();
});

/* FILTRY */
$('q').addEventListener('input', ()=>{ state.idx=0; applyFilter(); save(); }, {passive:true});
$('tag').addEventListener('change', ()=>{ state.idx=0; applyFilter(); save(); }, {passive:true});

/* START */
applyFilter(); // buduje grid
</script>
</body>
</html>
